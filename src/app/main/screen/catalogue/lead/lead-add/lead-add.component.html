<ng-container *ngIf="!isLoading">
  <div class="modal-header">
    <table class="panel">
      <tr>
        <td>
          <h6 class="modal-title">
            <label class="lbl-custom-left"
              >Sales Lead -
              <span>{{ action === "ADD" ? "Add New" : "Edit" }}</span></label
            >
          </h6>
        </td>
      </tr>
    </table>
    <button
      type="button"
      class="btn-close"
      aria-label="Close"
      (click)="close()"
    >
      <span aria-hidden="true">&times;</span>
    </button>
  </div>
  <div class="modal-body">
    <table class="panel">
      <tr>
        <ngb-tabset>
          <ngb-tab title="General">
            <ng-template ngbTabContent>
              <div class="scroll">
                <div style="height: 5px;"></div>
                <table class="panel-noheight">
                  <tr>
                    <table class="panel">
                      <tr>
                        <td style="width: 12%;">
                          <label class="lbl-custom-left">ID</label>
                        </td>
                        <td style="width: 25%;">
                          <input
                            type="text"
                            class="form-control form-control-sm"
                            [(ngModel)]="leadApi.partnerID"
                            disabled
                          />
                        </td>
                        <td></td>
                      </tr>
                    </table>
                  </tr>
                  <tr>
                    <table class="panel">
                      <tr>
                        <td style="width: 12%;">
                          <label class="lbl-custom-left"
                            >Name (Abbr)
                            <span style="color: red;">*</span></label
                          >
                        </td>
                        <td>
                          <input
                            type="text"
                            class="form-control form-control-sm"
                            ngbAutofocus
                            [(ngModel)]="leadApi.partnerNameAbbr"
                          />
                        </td>
                      </tr>
                    </table>
                  </tr>
                  <tr>
                    <table class="panel">
                      <tr>
                        <td style="width: 12%;">
                          <label class="lbl-custom-left"
                            >Name (Full-EN)
                            <span style="color: red;">*</span></label
                          >
                        </td>
                        <td>
                          <input
                            type="text"
                            class="form-control form-control-sm"
                            [(ngModel)]="leadApi.partnerNameFullEN"
                          />
                        </td>
                      </tr>
                    </table>
                  </tr>
                  <tr>
                    <table class="panel">
                      <tr>
                        <td style="width: 12%;">
                          <label class="lbl-custom-left">Name (Full-VN)</label>
                        </td>
                        <td>
                          <input
                            type="text"
                            class="form-control form-control-sm"
                            [(ngModel)]="leadApi.partnerNameFullVN"
                          />
                        </td>
                      </tr>
                    </table>
                  </tr>
                  <tr>
                    <table class="panel">
                      <tr>
                        <td style="width: 12%;">
                          <label class="lbl-custom-left">Coordinated by</label>
                        </td>
                        <td style="width: 30%;">
                          <of1-input-lookup2
                            class="contact"
                            [(ngModel)]="lead.saleManage"
                          >
                          </of1-input-lookup2>
                        </td>
                        <td></td>
                        <td style="width: 16%;">
                          <label class="lbl-custom-left"
                            >Mother/Sister Company</label
                          >
                        </td>
                        <td style="width: 30%;">
                          <of1-input-lookup2
                             class="customer"
                            [(ngModel)]="lead.officeAgent"
                          >
                          </of1-input-lookup2>
                        </td>
                      </tr>
                    </table>
                  </tr>
                </table>
                <div style="height: 5px;"></div>
                <ngb-accordion #general="ngbAccordion" activeIds="general-1">
                  <ngb-panel id="general-1">
                    <ng-template ngbPanelHeader let-opened="opened">
                      <button ngbPanelToggle class="btn btn-accordion">
                        <span
                          >{{ opened ? "&#045;" : "&#043;" }} Contact info</span
                        >
                      </button>
                      <div style="padding: 0.375rem 0rem;">
                        <button
                          class="btn-collapse btn-sm"
                          (click)="general.expandAll()"
                        >
                          Expand all
                        </button>
                      </div>
                      <div style="padding: 0.375rem 0rem;">
                        <button
                          class="btn-collapse btn-sm"
                          (click)="general.collapseAll()"
                        >
                          Collapse all
                        </button>
                      </div>
                    </ng-template>
                    <ng-template ngbPanelContent>
                      <table class="panel">
                        <tr>
                          <table class="panel">
                            <tr>
                              <td style="width: 14%;">
                                <label class="lbl-custom-left"
                                  >Main Addr (EN)
                                  <span style="color: red;">*</span></label
                                >
                              </td>
                              <td>
                                <input
                                  type="text"
                                  class="form-control form-control-sm"
                                  [(ngModel)]="addressEN.addressInfo"
                                />
                              </td>
                            </tr>
                          </table>
                        </tr>
                        <tr>
                          <table class="panel">
                            <tr>
                              <td style="width: 14%;">
                                <label class="lbl-custom-left"
                                  >Main Addr (LC)</label
                                >
                              </td>
                              <td>
                                <input
                                  type="text"
                                  class="form-control form-control-sm"
                                  [(ngModel)]="addressVN.addressInfo"
                                />
                              </td>
                            </tr>
                          </table>
                        </tr>
                        <tr>
                          <table class="panel">
                            <tr>
                              <td style="width: 14%;">
                                <label class="lbl-custom-left"
                                  >Country
                                  <span style="color: red;">*</span></label
                                >
                              </td>
                              <td style="width: 16%;">
                                <of1-input-lookup2
                                  class="country"
                                  [(ngModel)]="lead.country"
                                  (ngModelChange)="onChangeCountry()"
                                >
                                </of1-input-lookup2>
                              </td>
                              <td style="width: 2%;"></td>
                              <td style="width: 8%;">
                                <label class="lbl-custom-left">State</label>
                              </td>
                              <td style="width: 14%;">
                                <of1-input-lookup2
                                  class="state"
                                  [(ngModel)]="lead.state"
                                >
                                </of1-input-lookup2>
                              </td>
                              <td style="width: 2%;"></td>
                              <td style="width: 8%;">
                                <label class="lbl-custom-left"
                                  >City
                                  <span style="color: red;">*</span></label
                                >
                              </td>
                              <td style="width: 14%;">
                                <of1-input-lookup2
                                   class="city"
                                  [(ngModel)]="lead.city"
                                >
                                </of1-input-lookup2>
                              </td>
                              <td style="width: 2%;"></td>
                              <td style="width: 8%;">
                                <label class="lbl-custom-left">Zip Code</label>
                              </td>
                              <td style="width: 12%;">
                                <input
                                  type="text"
                                  class="form-control form-control-sm"
                                  [(ngModel)]="leadApi.zipCode"
                                />
                              </td>
                            </tr>
                          </table>
                        </tr>
                        <ng-container
                          *ngFor="
                            let addr of arrAddr;
                            index as indexAddr;
                            last as lastAddr
                          "
                        >
                          <tr>
                            <table class="panel">
                              <tr>
                                <td style="width: 14%;">
                                  <label class="lbl-custom-left"
                                    >Additional Addr{{
                                      indexAddr + 1
                                    }}
                                    (EN)</label
                                  >
                                </td>
                                <td style="width: 54%;">
                                  <input
                                    type="text"
                                    class="form-control form-control-sm"
                                    [(ngModel)]="addr.addressInfo"
                                  />
                                </td>
                                <td style="width: 5%;"></td>
                                <td style="width: 5%;">
                                  <label class="lbl-custom-left">Note</label>
                                </td>
                                <td>
                                  <input
                                    type="text"
                                    class="form-control form-control-sm"
                                    [(ngModel)]="addr.note"
                                  />
                                </td>
                                <ng-container *ngIf="lastAddr">
                                  <td style="width: 30px;">
                                    <button
                                      class="btn btn-more btn-sm"
                                      type="button"
                                      (click)="addMore()"
                                    >
                                      <i class="fas fa-plus-circle"></i>
                                    </button>
                                  </td>
                                </ng-container>
                              </tr>
                            </table>
                          </tr>
                        </ng-container>
                        <tr>
                          <table class="panel">
                            <tr>
                              <td style="width: 14%;">
                                <label class="lbl-custom-left">Tax Code</label>
                              </td>
                              <td style="width: 16%;">
                                <input
                                  type="text"
                                  class="form-control form-control-sm"
                                  [(ngModel)]="leadApi.taxCode"
                                />
                              </td>
                              <td style="width: 2%;"></td>
                              <td style="width: 8%;">
                                <label class="lbl-custom-left"
                                  >Phone 1
                                  <span style="color: red;">*</span></label
                                >
                              </td>
                              <td style="width: 14%;">
                                <input
                                  type="text"
                                  class="form-control form-control-sm"
                                  [(ngModel)]="leadApi.homePhone"
                                />
                              </td>
                              <td style="width: 2%;"></td>
                              <td style="width: 8%;">
                                <label class="lbl-custom-left">Phone 2</label>
                              </td>
                              <td style="width: 14%;">
                                <input
                                  type="text"
                                  class="form-control form-control-sm"
                                  [(ngModel)]="leadApi.workPhone"
                                />
                              </td>
                              <td style="width: 2%;"></td>
                              <td style="width: 8%;">
                                <label class="lbl-custom-left">Fax</label>
                              </td>
                              <td style="width: 12%;">
                                <input
                                  type="text"
                                  class="form-control form-control-sm"
                                  [(ngModel)]="leadApi.faxNumber"
                                />
                              </td>
                            </tr>
                          </table>
                        </tr>
                        <tr>
                          <table class="panel">
                            <tr>
                              <td style="width: 14%;">
                                <label class="lbl-custom-left"
                                  >Email
                                  <span style="color: red;">*</span></label
                                >
                              </td>
                              <td style="width: 32%;">
                                <div class="input-group">
                                  <input
                                    type="text"
                                    class="form-control form-control-sm"
                                    [(ngModel)]="leadApi.email"
                                  />
                                </div>
                              </td>
                              <td style="width: 8%;"></td>
                              <td style="width: 14%;">
                                <label class="lbl-custom-left">Website</label>
                              </td>
                              <td style="width: 32%;">
                                <div class="input-group">
                                  <input
                                    type="text"
                                    class="form-control form-control-sm"
                                    [(ngModel)]="leadApi.website"
                                  />
                                </div>
                              </td>
                            </tr>
                          </table>
                        </tr>
                      </table>
                    </ng-template>
                  </ngb-panel>
                  <ngb-panel id="general-2">
                    <ng-template ngbPanelHeader let-opened="opened">
                      <button ngbPanelToggle class="btn btn-accordion">
                        <span>{{ opened ? "&#045;" : "&#043;" }} Note</span>
                      </button>
                    </ng-template>
                    <ng-template ngbPanelContent>
                      <table class="panel">
                        <tr>
                          <table class="panel">
                            <tr>
                              <td style="width: 12%;">
                                <label class="lbl-custom-left">Created</label>
                              </td>
                              <td style="width: 18%;">
                                <of1-input-date
                                  disabled="true"
                                  [(ngModel)]="leadApi.dateCreate"
                                >
                                </of1-input-date>
                              </td>
                              <td style="width: 6%;"></td>
                              <td style="width: 4%;">
                                <label class="lbl-custom-left">by</label>
                              </td>
                              <td style="width: 18%;">
                                <input
                                  type="text"
                                  class="form-control form-control-sm"
                                  [(ngModel)]="leadApi.creator"
                                  disabled
                                />
                              </td>
                              <td></td>
                            </tr>
                          </table>
                        </tr>
                        <tr>
                          <table class="panel">
                            <tr>
                              <td style="width: 12%;">
                                <label class="lbl-custom-left"
                                  >Last updated</label
                                >
                              </td>
                              <td style="width: 18%;">
                                <of1-input-date
                                  disabled="true"
                                  [(ngModel)]="leadApi.dateModify"
                                >
                                </of1-input-date>
                              </td>
                              <td style="width: 6%;"></td>
                              <td style="width: 4%;">
                                <label class="lbl-custom-left">by</label>
                              </td>
                              <td style="width: 18%;">
                                <input
                                  type="text"
                                  class="form-control form-control-sm"
                                  [(ngModel)]="leadApi.creator"
                                  disabled
                                />
                              </td>
                              <td></td>
                            </tr>
                          </table>
                        </tr>
                        <tr>
                          <table class="panel">
                            <tr>
                              <td style="width: 12%;">
                                <label class="lbl-custom-left">Note</label>
                              </td>
                              <td>
                                <textarea
                                  type="text"
                                  class="form-control form-control-sm"
                                  rows="5"
                                  [(ngModel)]="leadApi.notes"
                                ></textarea>
                              </td>
                            </tr>
                          </table>
                        </tr>
                      </table>
                    </ng-template>
                  </ngb-panel>
                </ngb-accordion>
              </div>
            </ng-template>
          </ngb-tab>
          <ngb-tab title="Contact Persons">
            <ng-template ngbTabContent>
              <div class="scroll">
                <table class="panel">
                  <tr>
                    <table class="panel">
                      <tr style="height: 100%;">
                        <ag-grid-angular
                          style="width: 100%; height: 100%;"
                          class="ag-theme-balham"
                          [columnDefs]="columnDefsCont"
                          [rowData]="rowDataCont"
                          rowSelection="single"
                          rowModelType="infinite"
                          [suppressMenuHide]="true"
                          [defaultColDef]="defaultColDef"
                          [frameworkComponents]="frameworkComponents"
                          (rowDoubleClicked)="editCont($event)"
                          (gridReady)="onGridReadyCont($event)"
                        >
                        </ag-grid-angular>
                      </tr>
                    </table>
                  </tr>
                  <tr style="height: 32px;">
                    <table class="panel">
                      <tr>
                        <td></td>
                        <td style="width: 91px;">
                          <button
                            class="btn btn-custom btn-sm"
                            type="button"
                            (click)="addNewCont()"
                          >
                            Add New
                          </button>
                        </td>
                        <td style="width: 71px;">
                          <button
                            class="btn btn-custom btn-sm"
                            type="button"
                            (click)="deleteCont()"
                          >
                            Delete
                          </button>
                        </td>
                      </tr>
                    </table>
                  </tr>
                </table>
              </div>
            </ng-template>
          </ngb-tab>
          <ngb-tab title="Transaction">
            <ng-template ngbTabContent>
              <div class="scroll">
                <table class="panel">
                  <tr>
                    <table class="panel">
                      <tr style="height: 100%;">
                        <ag-grid-angular
                          style="width: 100%; height: 100%;"
                          class="ag-theme-balham"
                          [rowData]="rowDataTrans"
                          [columnDefs]="columnDefsTrans"
                          [suppressMenuHide]="true"
                          [defaultColDef]="defaultColDef"
                          [frameworkComponents]="frameworkComponents"
                          rowSelection="single"
                          (rowDoubleClicked)="editTrans($event)"
                          (gridReady)="onGridReadyTrans($event)"
                        >
                        </ag-grid-angular>
                      </tr>
                    </table>
                  </tr>
                  <tr style="height: 32px;">
                    <table class="panel">
                      <tr>
                        <td></td>
                        <td style="width: 91px;">
                          <button
                            class="btn btn-custom btn-sm"
                            type="button"
                            (click)="addNewTrans()"
                          >
                            Add New
                          </button>
                        </td>
                        <td style="width: 71px;">
                          <button
                            class="btn btn-custom btn-sm"
                            type="button"
                            (click)="deleteTrans()"
                          >
                            Delete
                          </button>
                        </td>
                      </tr>
                    </table>
                  </tr>
                </table>
              </div>
            </ng-template>
          </ngb-tab>
          <ngb-tab title="Quotation">
            <ng-template ngbTabContent>
              <div class="scroll">
                <table class="panel">
                  <tr>
                    <table class="panel">
                      <tr style="height: 100%;">
                        <ag-grid-angular
                          style="width: 100%; height: 100%;"
                          class="ag-theme-balham"
                          [rowData]="rowDataQuota"
                          [columnDefs]="columnDefsQuota"
                          [suppressMenuHide]="true"
                          [defaultColDef]="defaultColDef"
                          [frameworkComponents]="frameworkComponents"
                          rowSelection="single"
                        >
                        </ag-grid-angular>
                      </tr>
                    </table>
                  </tr>
                </table>
              </div>
            </ng-template>
          </ngb-tab>
        </ngb-tabset>
      </tr>
    </table>
  </div>
  <div class="modal-footer">
    <table class="panel">
      <tr>
        <td></td>
        <td style="width: 151px;">
          <button
            class="btn btn-custom btn-sm"
            type="button"
            (click)="convertCus()"
            *ngIf="action === 'EDIT'"
          >
            Convert to Customer
          </button>
        </td>
        <td style="width: 151px;">
          <button
            class="btn btn-custom btn-sm"
            type="button"
            (click)="quota()"
            *ngIf="action === 'EDIT'"
          >
            Make a Quotation
          </button>
        </td>
        <td style="width: 71px;">
          <button
            class="btn btn-custom btn-sm"
            type="button"
            (click)="delete()"
            *ngIf="action === 'EDIT'"
          >
            Delete
          </button>
        </td>
        <td style="width: 71px;">
          <button class="btn btn-custom btn-sm" type="button" (click)="close()">
            Cancel
          </button>
        </td>
        <td style="width: 71px;">
          <button class="btn btn-custom btn-sm" type="button" (click)="save()">
            Save
          </button>
        </td>
      </tr>
    </table>
  </div>
</ng-container>
<ngx-loading [show]="isLoading"></ngx-loading>
